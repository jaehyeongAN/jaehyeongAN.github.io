<!DOCTYPE html>
<html lang="en">

<head><meta name="generator" content="Hexo 3.9.0">

  <!-- Minima -->
  <!-- Hexo theme created by @adisaktijrs -->

  <!-- Basic Page Needs
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta charset="utf-8">

  
  <title>LSTM Autoencoder for Anomaly Detection</title>
  
  <link rel="sitemap" href="https://jaehyeongan.github.iositemap.xml">
  
  <link rel="canonical" href="https://jaehyeongan.github.io/2020/02/29/LSTM-Autoencoder-for-Anomaly-Detection/">
  
  <meta name="description" content="Introì§€ë‚œ í¬ìŠ¤íŒ…(Autoencoderì™€ LSTM Autoencoder)ì— ì´ì–´ LSTM Autoencoderë¥¼ í†µí•´ Anomaly Detectioní•˜ëŠ” ë°©ì•ˆì— ëŒ€í•´ ì†Œê°œí•˜ê³ ì í•œë‹¤. Autoencoderì˜ ê²½ìš° ë³´í†µ ì´ë¯¸ì§€ì˜ ìƒì„±ì´ë‚˜ ë³µì›ì— ë§ì´ ì‚¬ìš©ë˜ë©° ì´ëŸ¬í•œ ">
  
  
  <meta name="author" content>
  
  <meta property="og:image" content="https://jaehyeongan.github.ioundefined">
  
  <meta property="og:site_name" content="jaehyeong&#39;s ds">
  <meta property="og:type" content="article">
  <meta property="og:title" content="LSTM Autoencoder for Anomaly Detection">
  
  <meta property="og:description" content="Introì§€ë‚œ í¬ìŠ¤íŒ…(Autoencoderì™€ LSTM Autoencoder)ì— ì´ì–´ LSTM Autoencoderë¥¼ í†µí•´ Anomaly Detectioní•˜ëŠ” ë°©ì•ˆì— ëŒ€í•´ ì†Œê°œí•˜ê³ ì í•œë‹¤. Autoencoderì˜ ê²½ìš° ë³´í†µ ì´ë¯¸ì§€ì˜ ìƒì„±ì´ë‚˜ ë³µì›ì— ë§ì´ ì‚¬ìš©ë˜ë©° ì´ëŸ¬í•œ ">
  
  <meta property="og:url" content="https://jaehyeongan.github.io/2020/02/29/LSTM-Autoencoder-for-Anomaly-Detection/">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="LSTM Autoencoder for Anomaly Detection">
  
  <meta name="twitter:description" content="Introì§€ë‚œ í¬ìŠ¤íŒ…(Autoencoderì™€ LSTM Autoencoder)ì— ì´ì–´ LSTM Autoencoderë¥¼ í†µí•´ Anomaly Detectioní•˜ëŠ” ë°©ì•ˆì— ëŒ€í•´ ì†Œê°œí•˜ê³ ì í•œë‹¤. Autoencoderì˜ ê²½ìš° ë³´í†µ ì´ë¯¸ì§€ì˜ ìƒì„±ì´ë‚˜ ë³µì›ì— ë§ì´ ì‚¬ìš©ë˜ë©° ì´ëŸ¬í•œ ">
  
  
  <meta name="twitter:image" content="https://jaehyeongan.github.ioundefined">
  
  <meta name="twitter:url" content="https://jaehyeongan.github.io/2020/02/29/LSTM-Autoencoder-for-Anomaly-Detection/">

  <!-- Mobile Specific Metas
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Preload fonts
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="preload" href="../fonts/dm-serif-display-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="../fonts/inter-v2-latin-regular.woff2" as="font" type="font/woff2" crossorigin>

  <!-- CSS
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="stylesheet" href="/css/normalize.css">
  <link rel="stylesheet" href="/css/skeleton.css">
  <link rel="stylesheet" href="/css/custom.css">
  <link rel="stylesheet" href="/css/prism-dark.css">
  <link rel="stylesheet" href="/css/prism-line-numbers.css">
  <!-- User css -->
  
  <link rel="stylesheet" href="/css/user.css">
  

  <!-- Favicon
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="icon" type="image/png" href="/images/astronaut.png">

  <!-- Custom Theme Color Style
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <style>
  a:not(.icon) {
    text-decoration-color: #0FA0CE;
    background-image: linear-gradient(
      to bottom,
      rgba(0, 0, 0, 0) 50%,
      #0FA0CE 50%
    );
  }
  blockquote {
    border-left: 8px solid #0FA0CE;
  }
  .nanobar .bar {
    background: #0FA0CE;
  }
  .button.button-primary:hover,
  button.button-primary:hover,
  input[type="submit"].button-primary:hover,
  input[type="reset"].button-primary:hover,
  input[type="button"].button-primary:hover,
  .button.button-primary:focus,
  button.button-primary:focus,
  input[type="submit"].button-primary:focus,
  input[type="reset"].button-primary:focus,
  input[type="button"].button-primary:focus {
    background-color: #0FA0CE;
    border-color: #0FA0CE;
  }
  input[type="email"]:focus,
  input[type="number"]:focus,
  input[type="search"]:focus,
  input[type="text"]:focus,
  input[type="tel"]:focus,
  input[type="url"]:focus,
  input[type="password"]:focus,
  textarea:focus,
  select:focus {
    border: 1px solid #0FA0CE;
  }
</style>

  <!-- Google Analytics (With Privacy Settings On)
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  

</head>

<body>
  <div class="container">
    <div class="row">
      <div>

        <div class="row">
  <div class="two columns" style="max-width: 50px">
    <h1 class="mt-2 mode">
      <div onclick="setDarkMode(true)" id="darkBtn">ğŸŒ‘</div>
      <div onclick="setDarkMode(false)" id="lightBtn" class="hidden">â˜€ï¸</div>
      <script>
        if (localStorage.getItem('preferredTheme') == 'dark') {
          setDarkMode(true)
        }
        function setDarkMode(isDark) {
          var darkBtn = document.getElementById('darkBtn')
          var lightBtn = document.getElementById('lightBtn')
          if (isDark) {
            lightBtn.style.display = "block"
            darkBtn.style.display = "none"
            localStorage.setItem('preferredTheme', 'dark');
          } else {
            lightBtn.style.display = "none"
            darkBtn.style.display = "block"
            localStorage.removeItem('preferredTheme');
          }
          document.body.classList.toggle("darkmode");
        }
      </script>
    </h1>
  </div>

  <div class="six columns ml-1">
    <h1 class="mt-2">
      â¬… Apply Dark.
    </h1>
  </div>

  <div class="twelve columns">
    <div class="row">
      <div class="nine columns left">
        <a href="/">Home</a>
        
          
          <a href="/about" class="ml">About</a>
          
        
        
          
            <a href="mailto:nonamed000000@gmail.com" target="_blank" class="ml">Email</a>
          
        
      </div>
    </div>
    <hr style="margin-bottom: 2.6rem">
  </div>
</div>

        <div class="trans">
            <h2>LSTM Autoencoder for Anomaly Detection</h2>

  <h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>ì§€ë‚œ í¬ìŠ¤íŒ…(<a href="https://jaehyeongan.github.io/2020/02/28/Autoencoder-LSTMautoencoder/">Autoencoderì™€ LSTM Autoencoder</a>)ì— ì´ì–´ <strong>LSTM Autoencoderë¥¼ í†µí•´ Anomaly Detectioní•˜ëŠ” ë°©ì•ˆ</strong>ì— ëŒ€í•´ ì†Œê°œí•˜ê³ ì í•œë‹¤. Autoencoderì˜ ê²½ìš° ë³´í†µ ì´ë¯¸ì§€ì˜ ìƒì„±ì´ë‚˜ ë³µì›ì— ë§ì´ ì‚¬ìš©ë˜ë©° ì´ëŸ¬í•œ êµ¬ì¡°ë¥¼ ì´ì–´ë°›ì•„ ëŒ€í‘œì ì¸ ë”¥ëŸ¬ë‹ ìƒì„± ëª¨ë¸ì¸ GAN(Generative Adversarial Network)ìœ¼ë¡œ ê¹Œì§€ ì´ì–´ì¡ŒëŠ”ë° ì´ëŸ¬í•œ ìê¸° í•™ìŠµ ëª¨ë¸ì€ Anomaly Detection ë¶„ì•¼ì—ì„œë„ ë„ë¦¬ ì‚¬ìš©ë˜ê³  ìˆë‹¤.<br>ëŒ€í‘œì ìœ¼ë¡œ ì´ë¯¸ì§€ ë¶„ì•¼ì—ì„œë„ ì •ìƒì ì¸ ì´ë¯¸ì§€ë¡œ ëª¨ë¸ í•™ìŠµ í›„ ë¹„ì •ìƒì ì¸ ì´ë¯¸ì§€ë¥¼ ë„£ì–´ ì´ë¥¼ ë””ì½”ë”© í•˜ê²Œ ë˜ë©´ ì •ìƒ ì´ë¯¸ì§€ íŠ¹ì„±ê³¼ ë””ì½”ë”© ëœ ì´ë¯¸ì§€ ê°„ì˜ ì°¨ì´ì¸ ì¬êµ¬ì„± ì†ì‹¤(Reconstruction Error)ë¥¼ ê³„ì‚°í•˜ê²Œ ë˜ëŠ”ë° ì´ ì¬êµ¬ì„± ì†ì‹¤ì´ ë‚®ì€ ë¶€ë¶„ì€ ì •ìƒ(normal), ì¬êµ¬ì„± ì†ì‹¤ì´ ë†’ì€ ë¶€ë¶„ì€ ì´ìƒ(Abnormal)ë¡œ íŒë‹¨í•  ìˆ˜ ìˆë‹¤. </p>
<p>ì´ëŸ¬í•œ Anomaly Detectionì€ ì´ë¯¸ì§€ ë¿ë§Œ ì•„ë‹ˆë¼ ì´ì œë¶€í„° ì‚´í´ë³´ê³ ì í•˜ëŠ” ì‹œê³„ì—´ ë°ì´í„°ì—ë„ ì ìš©ì´ ê°€ëŠ¥í•˜ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ íŠ¹ì • ì„¤ë¹„ì˜ ì„¼ì„œë¥¼ í†µí•´ ë¹„ì •ìƒ ì‹ í˜¸ë¥¼ íƒì§€í•˜ê³ ì í•œë‹¤ë©´ Autoencoderë¥¼ LSTM ë ˆì´ì–´ë¡œ êµ¬ì„±í•œë‹¤ë©´ ì´ëŸ¬í•œ ì‹œí€€ìŠ¤ í•™ìŠµì´ ê°€ëŠ¥í•˜ê²Œ ëœë‹¤. ì´ë¥¼ í†µí•´ ì •ìƒ ì‹ í˜¸ë§Œì„ ì´ìš©í•˜ì—¬ ëª¨ë¸ì„ í•™ìŠµì‹œì¼œ ì¶”í›„ ë¹„ì •ìƒ ì‹ í˜¸ê°€ ëª¨ë¸ì— ì…ë ¥ë˜ë©´ ë†’ì€ reconstruction errorë¥¼ ë‚˜íƒ€ë‚¼ ê²ƒì´ë¯€ë¡œ ì´ë¥¼ ë¹„ì •ìƒ ì‹ í˜¸ë¡œ íŒë‹¨í•  ìˆ˜ ìˆê²Œ ëœë‹¤.</p>
<hr>
<h2 id="LSTM-Autoencoder"><a href="#LSTM-Autoencoder" class="headerlink" title="LSTM Autoencoder"></a>LSTM Autoencoder</h2><p><img src="/image/lstm-autoencoder-architecture2.png"></p>
<p>LSTM AutoencoderëŠ” ì‹œí€€ìŠ¤(sequence) ë°ì´í„°ì— Encoder-Decoder LSTM ì•„í‚¤í…ì²˜ë¥¼ ì ìš©í•˜ì—¬ êµ¬í˜„í•œ ì˜¤í† ì¸ì½”ë”ì´ë‹¤. ëª¨ë¸ì— ì…ë ¥ ì‹œí€€ìŠ¤ê°€ ìˆœì°¨ì ìœ¼ë¡œ ë“¤ì–´ì˜¤ê²Œ ë˜ê³ , ë§ˆì§€ë§‰ ì…ë ¥ ì‹œí€€ìŠ¤ê°€ ë“¤ì–´ì˜¨ í›„ ë””ì½”ë”ëŠ” ì…ë ¥ ì‹œí€€ìŠ¤ë¥¼ ì¬ìƒì„±í•˜ê±°ë‚˜ í˜¹ì€ ëª©í‘œ ì‹œí€€ìŠ¤ì— ëŒ€í•œ ì˜ˆì¸¡ì„ ì¶œë ¥í•œë‹¤.<br>ìœ„ì—ì„œ ì„¤ëª…í•œ ê²ƒê³¼ ë§ˆì°¬ê°€ì§€ë¡œ <strong>LSTM Autoencoder í•™ìŠµ ì‹œì—ëŠ” ì •ìƒ(normal) ì‹ í˜¸ì˜ ë°ì´í„°ë¡œë§Œ ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ê²Œ ëœë‹¤.</strong> encoderì™€ decoderëŠ” í•™ìŠµì´ ì§„í–‰ë  ìˆ˜ ë¡ ì •ìƒ ì‹ í˜¸ë¥¼ ë” ì •ìƒ ì‹ í˜¸ ë‹µê²Œ í‘œí˜„í•˜ëŠ” ë°©ë²•ì„ í•™ìŠµí•˜ê²Œ ë  ê²ƒì´ë©° ìµœì¢…ì ìœ¼ë¡œ ì¬êµ¬ì„± í•œ ê²°ê³¼ë„ ì •ìƒ ì‹ í˜¸ì™€ ë§¤ìš° ìœ ì‚¬í•œ ë¶„í¬ë¥¼ ê°€ì§€ëŠ” ë°ì´í„°ì¼ ê²ƒì´ë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì´ ëª¨ë¸ì— ë¹„ì •ìƒ ì‹ í˜¸ë¥¼ ì…ë ¥ìœ¼ë¡œ ë„£ê²Œ ë˜ë©´ ì •ìƒ ë¶„í¬ì™€ ë‹¤ë¥¸ íŠ¹ì„±ì˜ ë¶„í¬ë¥¼ ë‚˜íƒ€ë‚¼ ê²ƒì´ê¸° ë•Œë¬¸ì— ë†’ì€ reconstruction errorë¥¼ ë³´ì´ê²Œ ë  ê²ƒì´ë‹¤.<br><br></p>
<h2 id="Curve-Shiftingì„-ì ìš©í•œ-LSTM-Autoencoder"><a href="#Curve-Shiftingì„-ì ìš©í•œ-LSTM-Autoencoder" class="headerlink" title="Curve Shiftingì„ ì ìš©í•œ LSTM Autoencoder"></a>Curve Shiftingì„ ì ìš©í•œ LSTM Autoencoder</h2><p><img src="/image/lstm-autoencoder-through-curveshifting.png" width="800px"></p>
<p>ì „ì²´ í”„ë¡œì„¸ìŠ¤ëŠ” ìœ„ ì•„í‚¤í…ì²˜ì™€ ê°™ë‹¤. ë¨¼ì € Curve Shiftingì„ í†µí•´ ë°ì´í„°ì˜ ì‹œì ì„ ë³€í™˜í•´ì£¼ê³  normal ë°ì´í„°ë§Œì„ í†µí•´ LSTM Autoencoder ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ê²Œ ëœë‹¤. ê·¸ í›„ ì¬êµ¬ì„± ì†ì‹¤ì„ ê³„ì‚° í›„ Precision Recall Curveë¥¼ í†µí•´ normal/abnormalì„ êµ¬ë¶„í•˜ê¸° ìœ„í•œ thresholdë¥¼ ì§€ì •í•˜ê²Œ ë˜ê³  ì´ thresholdë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë§ˆì§€ë§‰ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ì…‹ì˜ ì¬êµ¬ì„± ì†ì‹¤ì„ ë¶„ë¥˜í•˜ì—¬ t+n ì‹œì ì„ ì˜ˆì¸¡í•˜ê²Œ ëœë‹¤.<br>ê° ë¶€ë¶„ì— ëŒ€í•´ ì•„ë˜ì—ì„œ ì¢€ ë” ìƒì„¸íˆ ì‚´í´ë³´ì.</p>
<h3 id="1-Curve-Shifting"><a href="#1-Curve-Shifting" class="headerlink" title="1. Curve Shifting"></a>1. Curve Shifting</h3><p>ë¹„ì •ìƒ ì‹ í˜¸ë¥¼ íƒì§€í•˜ê¸° ìœ„í•´ì„œëŠ” ë¹„ì •ìƒ ì‹ í˜¸ê°€ ë“¤ì–´ì˜¤ê¸° ì „ì— ì¦‰, ë­”ê°€ ê³ ì¥ í˜¹ì€ ê²°í•¨ì´ ë°œìƒí•˜ê¸° ì „ì— ë¯¸ë¦¬ ì˜ˆì¸¡ì„ í•´ì•¼ë§Œ í•œë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ë‹¨ìˆœíˆ í˜„ì¬ ì‹œì ì˜ errorë¥¼ ê³„ì‚°í•˜ì—¬ ë¹„ì •ìƒ ì‹ í˜¸ë¥¼ íƒì§€í•˜ëŠ” ê²ƒì€ ì´ë¯¸ ê³ ì¥ì´ ë°œìƒí•œ í›„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒê³¼ ë‹¤ë¦„ì´ ì—†ê¸° ë•Œë¬¸ì— <strong>ë°ì´í„°ì— ëŒ€í•œ ì‹œì  ë³€í™˜</strong>ì´ ê¼­ í•„ìš”í•˜ë‹¤. </p>
<p>ì´ëŸ¬í•œ future value ì˜ˆì¸¡ì„ ìœ„í•´ ë‹¤ì–‘í•œ ë°©ë²•ì´ ìˆëŠ”ë° ì—¬ê¸°ì„œëŠ” <strong>Curve Shifting</strong>ì´ë¼ëŠ” ê¸°ë²•ì„ ì ìš©í•  ê²ƒì´ë‹¤. </p>
<p><img src="/image/curve-shifting.png" width="400px"></p>
<p>Curve Shiftingì€ <strong>ì‚¬ì „ ì˜ˆì¸¡ ê°œë…</strong>ì„ ì ìš©í•˜ê¸° ìœ„í•œ Shifting ë°©ë²•ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ ë¹„ì •ìƒ ì‹ í˜¸(1)ë¥¼ 2ì¼ ì „ì— ì¡°ê¸° ì˜ˆì¸¡ í•˜ê³ ì í•œë‹¤ë©´ ë‹¨ìˆœíˆ Yê°’ì„ ë‘ ì¹¸ì”© ë‚´ë¦¬ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë¹„ì •ìƒ ì‹ í˜¸(1)ê°€ ìˆëŠ” ë‚ ì§œë¡œë¶€í„° 2ì¼ ì „ê¹Œì§€ì˜ ë°ì´í„°ë¥¼ ë¹„ì •ìƒ ì‹ í˜¸(1)ë¡œ ë°”ê¾¸ì–´ì£¼ëŠ” ê²ƒì´ë‹¤. ì´ëŠ” ë¹„ì •ìƒ ì‹ í˜¸ê°€ ë°œìƒí•˜ê¸° ì „ ì–´ë– í•œ ì¡°ì§ì´ ìˆì„ ê²ƒì´ë©° ì´ëŸ¬í•œ ì¡°ì§ì´ ë°ì´í„° íŠ¹ì„±ì— ë‚˜íƒ€ë‚  ê²ƒì´ë¼ëŠ” ê°€ì •ì„ ê°€ì§€ê³  í•™ìŠµí•˜ëŠ” ë°©ë²•ì´ë‹¤.<br>ê·¸ë¦¬ê³  ë‚˜ì„œ ë³¸ë˜ ë¹„ì •ìƒ ì‹ í˜¸(1) ë°ì´í„°ë¥¼ ì œê±°í•´ì£¼ëŠ”ë° ì´ë ‡ê²Œ í•˜ëŠ” ì´ìœ ëŠ” ë¼ë²¨ì„ ë°”ê¿”ì£¼ëŠ” ìˆœê°„ ì´ëŠ” ë¹„ì •ìƒ ì‹ í˜¸ ì˜ˆì¸¡ ë¬¸ì œê°€ ì•„ë‹Œ ë¹„ì •ìƒ ì‹ í˜¸ ì¡°ì§ ì˜ˆì¸¡ ë¬¸ì œê°€ ë˜ëŠ” ê²ƒì´ ë•Œë¬¸ì— ë°ì´í„°ì˜ í•™ìŠµ í˜¼ë™ì„ ì—†ì• ì£¼ê¸° ìœ„í•´ ì œê±°í•˜ëŠ” ê²ƒì´ë¼ ë³´ë©´ ë  ê²ƒì´ë‹¤.<br><br></p>
<h3 id="2-Threshold-by-Precision-Recall-Curve"><a href="#2-Threshold-by-Precision-Recall-Curve" class="headerlink" title="2. Threshold by Precision-Recall-Curve"></a>2. Threshold by Precision-Recall-Curve</h3><p>AutoencoderëŠ” ì¬êµ¬ì„± ëœ ê²°ê³¼ë¥¼ intputê³¼ ë¹„êµí•˜ì—¬ ì¬êµ¬ì„± ì†ì‹¤(Reconstruction Error)ë¥¼ ê³„ì‚°í•œë‹¤ê³  ë§í–ˆë‹¤. ê·¸ë¦¬ê³  ì´ ì¬êµ¬ì„± ì†ì‹¤ê°’ì„ í†µí•´ ì†ì‹¤ê°’ì´ ë‚®ìœ¼ë©´ ì •ìƒìœ¼ë¡œ, ì†ì‹¤ê°’ì´ ë†’ìœ¼ë©´ ì´ìƒìœ¼ë¡œ íŒë‹¨í•œë‹¤ê³  í•˜ì˜€ëŠ”ë°, ì´ ì •ìƒê³¼ ì´ìƒì„ ë‚˜ëˆ„ëŠ” ê¸°ì¤€ì€ ê³¼ì—° ë¬´ì—‡ì¼ê¹Œ?<br>ì¼ë°˜ì ìœ¼ë¡œ ëª¨ë¸ì´ ì •ìƒ ë°ì´í„°ë§Œìœ¼ë¡œ í•™ìŠµì„ í•˜ì—¬ ì •ìƒ ë°ì´í„°ë¥¼ ì¬êµ¬ì„±í•˜ì˜€ì„ ë•Œ í•™ìŠµì´ ì˜ ë˜ì—ˆë‹¤ê³  ê°€ì •í•˜ë©´ ì†ì‹¤ê°’ì€ 0ì— ê°€ê¹Œìš¸ ê²ƒì´ê³ , í•™ìŠµì´ ì˜ ì•ˆë˜ì—ˆë‹¤ê³  í•˜ë©´ ì†ì‹¤ê°’ì€ 1ì— ê°€ê¹Œìš¸ ê²ƒì´ë‹¤. ë³´í†µ ë¶„ë¥˜(Classification)ë¬¸ì œì—ì„œëŠ” ì˜ˆì¸¡ í™•ë¥ ê°’(0% ~ 100%)ì„ í†µí•´ 50%ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë¶„ë¥˜ë¥¼ í•˜ê²Œ ë˜ëŠ”ë°, ì´ recontruction errorì˜ ê²½ìš° ê·¸ë ‡ê²Œ ê·¹ë‹¨ì ìœ¼ë¡œ ê°’ì´ íŠ€ê¸°ëŠ” í˜ë“¤ê¸° ë•Œë¬¸ì— ì •ìƒê³¼ ì´ìƒì„ ë¶„ë¦¬í•˜ëŠ” íƒ€ë‹¹í•œ thresholdê°’ì„ ì •í•˜ëŠ” ê²ƒì´ í•„ìš”í•˜ë‹¤. </p>
<h4 id="Precision-Recall-Curve"><a href="#Precision-Recall-Curve" class="headerlink" title="Precision Recall Curve"></a>Precision Recall Curve</h4><p><img src="/image/precision-recall-curve.png" width="600px"></p>
<p>ìœ„ì™€ ê°™ì€ ë¬¸ì œì˜ ì ì ˆí•œ thresholdê°’ì„ ì ìš©í•˜ê¸° ìœ„í•œ ë°©ë²• ì¤‘ í•˜ë‚˜ë¡œ precision recall curveê°€ ìˆë‹¤. ì´ëŠ” Recall(ì¬í˜„ìœ¨)ê³¼ Precision(ì •ë°€ë„)ê°€ ì„œë¡œ Trade off ê´€ê³„ë¥¼ ê°€ì§€ê¸° ë•Œë¬¸ì— ì–´ëŠ í•œìª½ì— ì¹˜ìš°ì§€ì§€ ì•ŠëŠ” ìµœì ì˜ thresholdë¥¼ êµ¬í•˜ê¸° ìœ„í•œ ë°©ë²•ì´ë‹¤.<br>ì¶”í›„ ì´ ê²€ì¦ ê¸°ë²•ì„ ì ìš©í•˜ì—¬ LSTM Autoencoderë¥¼ í†µí•´ ì¬êµ¬ì„± ëœ ì •ìƒ ì‹ í˜¸ì™€ ë¹„ì •ìƒ ì‹ í˜¸ë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•œ ì ì ˆí•œ thresholdë¥¼ ì°¾ì•„ë‚¼ ê²ƒì´ë‹¤.<br><br></p>
<h2 id="Implementation"><a href="#Implementation" class="headerlink" title="Implementation"></a>Implementation</h2><p>ì ìš©í•´ ë³¼ ë°ì´í„°ëŠ” í„í”„ ì œì§€ ê³µì¥ì˜ Sheet breaks(ì¢…ì´ ì”¹í˜)ì— ê´€í•œ ì´ì§„ ë¼ë²¨ ë°ì´í„°ì´ë‹¤. ë°ì´í„° ì„¤ëª…ì— ë”°ë¥´ë©´ í•´ë‹¹ ê³µì¥ì—ì„œ í•œë²ˆ sheet breakê°€ ë°œìƒí•˜ë©´ ìˆ˜ì²œ ë‹¬ëŸ¬ì˜ ì†í•´ê°€ ë°œìƒí•œë‹¤ê³  í•˜ë©°, ì´ëŸ¬í•œ ì‚¬ê³ ê°€ ì ì–´ë„ ë§¤ì¼ í•œ ë²ˆ ì´ìƒ ë°œìƒí•œë‹¤ê³  í•œë‹¤.<br>í•´ë‹¹ ë°ì´í„°ëŠ” 15ì¼ì¹˜ì— í•´ë‹¹í•˜ëŠ” 18,268 rowsë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©° ì´ ì¤‘ sheet breakì— í•´ë‹¹í•˜ëŠ” positive labelì˜ ë¹„ìœ¨ì€ 124ê°œë¡œ ì „ì²´ ë°ì´í„°ì˜ 0.6%ë¥¼ ì°¨ì§€í•˜ê³  ìˆë‹¤.<br>ë°ì´í„°ëŠ” <a href="https://docs.google.com/forms/d/e/1FAIpQLSdyUk3lfDl7I5KYK_pw285LCApc-_RcoC0Tf9cnDnZ_TWzPAw/viewform" target="_blank" rel="noopener">ì—¬ê¸°</a>ì—ì„œ ì‹ ì²­ í›„ ë°›ì„ ìˆ˜ ìˆë‹¤.</p>
<h3 id="1-Import-Libraries"><a href="#1-Import-Libraries" class="headerlink" title="1. Import Libraries"></a>1. Import Libraries</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">from</span> pylab <span class="keyword">import</span> rcParams</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> Model ,models, layers, optimizers, regularizers</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.callbacks <span class="keyword">import</span> ModelCheckpoint</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics</span><br></pre></td></tr></table></figure>
<h3 id="2-Load-Data"><a href="#2-Load-Data" class="headerlink" title="2. Load Data"></a>2. Load Data</h3><p>timeê³¼ ë¼ë²¨ yê°’ì„ ë¹¼ë©´ ì´ 61ê°œì˜ ì¹¼ëŸ¼ì„ ê°€ì§€ê³  ìˆë‹¤.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LABELS = [<span class="string">'Normal'</span>, <span class="string">'Break'</span>]</span><br><span class="line"></span><br><span class="line">df = pd.read_csv(<span class="string">'./data/processminer-rare-event-mts-csv.csv'</span>)</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure></p>
<p><img src="/image/lstm-autoencoder-code1.PNG"></p>
<p>normal(0)ì´ 18,274ê±´, break(1)ê°€ 124ê±´ìœ¼ë¡œ êµ¬ì„± ë˜ì–´ìˆë‹¤.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Counter(df[<span class="string">'y'</span>])  <span class="comment"># Counter(&#123;0: 18274, 1: 124&#125;)</span></span><br></pre></td></tr></table></figure></p>
<h3 id="3-Curve-Shifting"><a href="#3-Curve-Shifting" class="headerlink" title="3. Curve Shifting"></a>3. Curve Shifting</h3><p>time ì¹¼ëŸ¼ì„ ë³´ë©´ 2ë¶„ ë‹¨ìœ„ë¡œ ë°ì´í„°ê°€ ë‚˜ëˆ„ì–´ì ¸ ìˆëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì—¬ê¸°ì„œì˜ ëª©í‘œëŠ” breakê°€ ë°œìƒí•˜ê¸° 4ë¶„ ì „ì— ì¡°ê¸° ì˜ˆì¸¡í•˜ëŠ” ê²ƒì´ë‹¤. ê·¸ëŸ¬ë¯€ë¡œ 4ë¶„ ì „ê¹Œì§€ì˜ ë°ì´í„°ë¥¼ break ë°ì´í„°ë¡œ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” curve shiftingì„ 2ê°œì˜ rowë§Œí¼ë§Œ ì ìš©í•˜ë©´ ëœë‹¤. ì´í›„, ë³¸ë˜ break ë°ì´í„°ëŠ” ì œê±°í•œë‹¤.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">sign = <span class="keyword">lambda</span> x: (<span class="number">1</span>, <span class="number">-1</span>)[x &lt; <span class="number">0</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">curve_shift</span><span class="params">(df, shift_by)</span>:</span></span><br><span class="line">	vector = df[<span class="string">'y'</span>].copy()</span><br><span class="line">	<span class="keyword">for</span> s <span class="keyword">in</span> range(abs(shift_by)):</span><br><span class="line">		tmp = vector.shift(sign(shift_by))</span><br><span class="line">		tmp = tmp.fillna(<span class="number">0</span>)</span><br><span class="line">		vector += tmp</span><br><span class="line">	labelcol = <span class="string">'y'</span></span><br><span class="line">	<span class="comment"># Add vector to the df</span></span><br><span class="line">	df.insert(loc=<span class="number">0</span>, column=labelcol+<span class="string">'tmp'</span>, value=vector)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># Remove the rows with labelcol == 1.</span></span><br><span class="line">	df = df.drop(df[df[labelcol] == <span class="number">1</span>].index)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># Drop labelcol and rename the tmp col as labelcol</span></span><br><span class="line">	df = df.drop(labelcol, axis=<span class="number">1</span>)</span><br><span class="line">	df = df.rename(columns=&#123;labelcol+<span class="string">'tmp'</span>: labelcol&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># Make the labelcol binary</span></span><br><span class="line">	df.loc[df[labelcol] &gt; <span class="number">0</span>, labelcol] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> df</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># shift the response column y by 2 rows to do a 4-min ahead prediction</span></span><br><span class="line">shifted_df = curve_shift(df, shift_by=<span class="number">-5</span>)</span><br><span class="line">shifted_df.head()</span><br></pre></td></tr></table></figure>
<p><img src="/image/lstm-autoencoder-code2.PNG"></p>
<p>ëª‡ ê°€ì§€ ë¶ˆí•„ìš”í•œ ë°ì´í„°ëŠ” ì œê±°í•œ í›„, ë°ì´í„°ì™€ ë¼ë²¨ì„ ë¶„ë¦¬í•´ì¤€ë‹¤.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># drop remove columns</span></span><br><span class="line">shifted_df = shifted_df.drop([<span class="string">'time'</span>,<span class="string">'x28'</span>,<span class="string">'x61'</span>], axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># x, y</span></span><br><span class="line">input_x = shifted_df.drop(<span class="string">'y'</span>, axis=<span class="number">1</span>).values</span><br><span class="line">input_y = shifted_df[<span class="string">'y'</span>].values</span><br><span class="line"></span><br><span class="line">n_features = input_x.shape[<span class="number">1</span>]</span><br></pre></td></tr></table></figure></p>
<h3 id="4-Transform-to-Series-Data"><a href="#4-Transform-to-Series-Data" class="headerlink" title="4. Transform to Series Data"></a>4. Transform to Series Data</h3><p>LSTM ëª¨ë¸ì€ (samples, timesteps, feature)ì— í•´ë‹¹í•˜ëŠ” 3d ì°¨ì›ì˜ shapeì„ ê°€ì§€ë¯€ë¡œ, ë°ì´í„°ë¥¼ ì‹œí€€ìŠ¤ í˜•íƒœë¡œ ë³€í™˜í•œë‹¤. timestepsì€ 5(ì¦‰, 10ë¶„)ë§Œí¼ ì¡ì•˜ë‹¤.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">temporalize</span><span class="params">(X, y, timesteps)</span>:</span></span><br><span class="line">	output_X = []</span><br><span class="line">	output_y = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(X) - timesteps - <span class="number">1</span>):</span><br><span class="line">		t = []</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, timesteps + <span class="number">1</span>):</span><br><span class="line">			<span class="comment"># Gather the past records upto the lookback period</span></span><br><span class="line">			t.append(X[[(i + j + <span class="number">1</span>)], :])</span><br><span class="line">		output_X.append(t)</span><br><span class="line">		output_y.append(y[i + timesteps + <span class="number">1</span>])</span><br><span class="line">	<span class="keyword">return</span> np.squeeze(np.array(output_X)), np.array(output_y)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">timesteps = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Temporalize</span></span><br><span class="line">x, y = temporalize(input_x, input_y, timesteps)</span><br><span class="line">print(x.shape) <span class="comment"># (18268, 5, 59)</span></span><br></pre></td></tr></table></figure>
<h3 id="5-Split-Train-Valid-Test"><a href="#5-Split-Train-Valid-Test" class="headerlink" title="5. Split Train / Valid / Test"></a>5. Split Train / Valid / Test</h3><p>ì´í›„, í›ˆë ¨, ê²€ì¦, í…ŒìŠ¤íŠ¸ ìš© ë°ì´í„°ë¡œ ë¶„ë¦¬í•œë‹¤. ê°ê° 11,691, 2,923, 3,654ê°œë¡œ ë‚˜ëˆ„ì–´ì£¼ì—ˆë‹¤.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Split into train, valid, and test </span></span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=<span class="number">0.2</span>)</span><br><span class="line">x_train, x_valid, y_train, y_valid = train_test_split(x_train, y_train, test_size=<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line">print(len(x_train))  <span class="comment"># 11691</span></span><br><span class="line">print(len(x_valid))  <span class="comment"># 2923</span></span><br><span class="line">print(len(x_test))   <span class="comment"># 3654</span></span><br></pre></td></tr></table></figure></p>
<p>LSTM Autoencoder í•™ìŠµ ì‹œì—ëŠ” Normal(0) ë°ì´í„°ë§Œìœ¼ë¡œ í•™ìŠµí•  ê²ƒì´ê¸° ë•Œë¬¸ì— ë°ì´í„°ë¡œ ë¶€í„° Normal(0)ê³¼ Break(1) ë°ì´í„°ë¥¼ ë¶„ë¦¬í•œë‹¤.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># For training the autoencoder, split 0 / 1</span></span><br><span class="line">x_train_y0 = x_train[y_train == <span class="number">0</span>]</span><br><span class="line">x_train_y1 = x_train[y_train == <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">x_valid_y0 = x_valid[y_valid == <span class="number">0</span>]</span><br><span class="line">x_valid_y1 = x_valid[y_valid == <span class="number">1</span>]</span><br></pre></td></tr></table></figure></p>
<h3 id="6-Standardize"><a href="#6-Standardize" class="headerlink" title="6. Standardize"></a>6. Standardize</h3><p>ê°ê¸° ë‹¤ë¥¸ ë°ì´í„° íŠ¹ì„±ì˜ í‘œì¤€í™”ë¥¼ ìœ„í•´ z-score ì •ê·œí™”ì¸ scikit-learnì˜ StandardScaler()ë¥¼ ì ìš©í•˜ì˜€ë‹¤. í•´ë‹¹ í•¨ìˆ˜ë¥¼ ì ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” 2d í˜•íƒœì—¬ì•¼ í•˜ë¯€ë¡œ Flatten ê³¼ì •ì„ ê±°ì¹œ í›„ ìŠ¤ì¼€ì¼ì„ ì ìš©í•˜ì˜€ìœ¼ë©° ì´í›„ ë‹¤ì‹œ 3d í˜•íƒœë¡œ ë³€í™˜í•˜ì˜€ë‹¤.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flatten</span><span class="params">(X)</span>:</span></span><br><span class="line">    flattened_X = np.empty((X.shape[<span class="number">0</span>], X.shape[<span class="number">2</span>]))  <span class="comment"># sample x features array.</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(X.shape[<span class="number">0</span>]):</span><br><span class="line">        flattened_X[i] = X[i, (X.shape[<span class="number">1</span>]<span class="number">-1</span>), :]</span><br><span class="line">    <span class="keyword">return</span>(flattened_X)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scale</span><span class="params">(X, scaler)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(X.shape[<span class="number">0</span>]):</span><br><span class="line">        X[i, :, :] = scaler.transform(X[i, :, :])</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> X</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">scaler = StandardScaler().fit(flatten(x_train_y0))</span><br><span class="line"></span><br><span class="line">x_train_y0_scaled = scale(x_train_y0, scaler)</span><br><span class="line">x_valid_scaled = scale(x_valid, scaler)</span><br><span class="line">x_valid_y0_scaled = scale(x_valid_y0, scaler)</span><br><span class="line">x_test_scaled = scale(x_test, scaler)</span><br></pre></td></tr></table></figure>
<h3 id="7-Training-LSTM-Autoencoder"><a href="#7-Training-LSTM-Autoencoder" class="headerlink" title="7. Training LSTM Autoencoder"></a>7. Training LSTM Autoencoder</h3><p>ëŒ€ì¹­ êµ¬ì¡°ì˜ Staked Autoencoder í˜•íƒœë¡œ LSTM Autoencoderë¥¼ êµ¬ì„±í•˜ì—¬ ì •ìƒ ë°ì´í„°ë¡œë§Œ êµ¬ì„± ëœ ë°ì´í„°ë¥¼ í†µí•´ ì´ 200 epoch í•™ìŠµì‹œì¼°ë‹¤.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">epochs = <span class="number">200</span></span><br><span class="line">batch = <span class="number">128</span></span><br><span class="line">lr = <span class="number">0.001</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">lstm_ae = models.Sequential()</span><br><span class="line"><span class="comment"># Encoder</span></span><br><span class="line">lstm_ae.add(layers.LSTM(<span class="number">32</span>, activation=<span class="string">'relu'</span>, input_shape=(timesteps, n_features), return_sequences=<span class="keyword">True</span>))</span><br><span class="line">lstm_ae.add(layers.LSTM(<span class="number">16</span>, activation=<span class="string">'relu'</span>, return_sequences=<span class="keyword">False</span>))</span><br><span class="line">lstm_ae.add(layers.RepeatVector(timesteps))</span><br><span class="line"><span class="comment"># Decoder</span></span><br><span class="line">lstm_ae.add(layers.LSTM(<span class="number">16</span>, activation=<span class="string">'relu'</span>, return_sequences=<span class="keyword">True</span>))</span><br><span class="line">lstm_ae.add(layers.LSTM(<span class="number">32</span>, activation=<span class="string">'relu'</span>, return_sequences=<span class="keyword">True</span>))</span><br><span class="line">lstm_ae.add(layers.TimeDistributed(layers.Dense(n_features)))</span><br><span class="line"></span><br><span class="line">lstm_ae.summary()</span><br></pre></td></tr></table></figure>
<p><img src="/image/lstm-autoencoder-code3.PNG"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># compile</span></span><br><span class="line">lstm_ae.compile(loss=<span class="string">'mse'</span>, optimizer=optimizers.Adam(lr))</span><br><span class="line"></span><br><span class="line"><span class="comment"># fit</span></span><br><span class="line">history = lstm_ae.fit(x_train_y0_scaled, x_train_y0_scaled,</span><br><span class="line">                     epochs=epochs, batch_size=batch,</span><br><span class="line">                     validation_data=(x_valid_y0_scaled, x_valid_y0_scaled))</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Train on 11314 samples, validate on 2830 samples</span><br><span class="line">Epoch 1/200</span><br><span class="line">11314/11314 [==============================] - 4s 393us/sample - loss: 0.8505 - val_loss: 0.6345</span><br><span class="line">Epoch 2/200</span><br><span class="line">11314/11314 [==============================] - 1s 86us/sample - loss: 0.5249 - val_loss: 0.4738</span><br><span class="line">Epoch 3/200</span><br><span class="line">11314/11314 [==============================] - 1s 83us/sample - loss: 0.4049 - val_loss: 0.3784</span><br><span class="line"></span><br><span class="line">	:			:			:			:		</span><br><span class="line"></span><br><span class="line">Epoch 198/200</span><br><span class="line">11314/11314 [==============================] - 1s 94us/sample - loss: 0.1256 - val_loss: 0.1308</span><br><span class="line">Epoch 199/200</span><br><span class="line">11314/11314 [==============================] - 1s 97us/sample - loss: 0.1209 - val_loss: 0.1282</span><br><span class="line">Epoch 200/200</span><br><span class="line">11314/11314 [==============================] - 1s 96us/sample - loss: 0.1212 - val_loss: 0.1308</span><br></pre></td></tr></table></figure>
<p>train lossì™€ valid loss ëª¨ë‘ 0.1ê·¼ì²˜ë¡œ ìˆ˜ë ´í•˜ê³  ìˆë‹¤.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">plt.plot(history.history[<span class="string">'loss'</span>], label=<span class="string">'train loss'</span>)</span><br><span class="line">plt.plot(history.history[<span class="string">'val_loss'</span>], label=<span class="string">'valid loss'</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.xlabel(<span class="string">'Epoch'</span>); plt.ylabel(<span class="string">'loss'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></p>
<p><img src="/image/lstm-autoencoder-code4.PNG"></p>
<h3 id="8-Threshold-by-Precision-Recall-Curve"><a href="#8-Threshold-by-Precision-Recall-Curve" class="headerlink" title="8. Threshold by Precision Recall Curve"></a>8. Threshold by Precision Recall Curve</h3><p>normalê³¼ breakë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•œ thresholdë¥¼ ì§€ì •í•˜ê¸° ìœ„í•´ precision recall curveë¥¼ ì ìš©í•œë‹¤. ì£¼ì˜í•´ì•¼í•  ê²ƒì€ ë””ì½”ë”© ëœ ì¬êµ¬ì„± ê²°ê³¼ê°€ ì•„ë‹Œ ì¬êµ¬ì„± ì†ì‹¤(reconstruction error)ì™€ ì‹¤ì œ ë¼ë²¨ ê°’ì„ ë¹„êµí•œë‹¤ëŠ” ê²ƒì´ë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">valid_x_predictions = lstm_ae.predict(x_valid_scaled)</span><br><span class="line">mse = np.mean(np.power(flatten(x_valid_scaled) - flatten(valid_x_predictions), <span class="number">2</span>), axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">error_df = pd.DataFrame(&#123;<span class="string">'Reconstruction_error'</span>:mse, </span><br><span class="line">                         <span class="string">'True_class'</span>:list(y_valid)&#125;)</span><br><span class="line">precision_rt, recall_rt, threshold_rt = metrics.precision_recall_curve(error_df[<span class="string">'True_class'</span>], error_df[<span class="string">'Reconstruction_error'</span>])</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">8</span>,<span class="number">5</span>))</span><br><span class="line">plt.plot(threshold_rt, precision_rt[<span class="number">1</span>:], label=<span class="string">'Precision'</span>)</span><br><span class="line">plt.plot(threshold_rt, recall_rt[<span class="number">1</span>:], label=<span class="string">'Recall'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'Threshold'</span>); plt.ylabel(<span class="string">'Precision/Recall'</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/image/lstm-autoencoder-code5.PNG"></p>
<p>ì—¬ê¸°ì„œ thresholdì˜ ê²½ìš° <strong>Recallê³¼ Precisionì˜ ê°’ì´ êµì°¨ë˜ëŠ” ì§€ì ì„ ìµœì ì˜ threshold ì§€ì ìœ¼ë¡œ ì¡ì•˜ë‹¤.</strong><br>ì—¬ê¸°ì„œ ìµœì ì˜ thresholdëŠ” 0.407ì´ë‹¤.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># best position of threshold</span></span><br><span class="line">index_cnt = [cnt <span class="keyword">for</span> cnt, (p, r) <span class="keyword">in</span> enumerate(zip(precision_rt, recall_rt)) <span class="keyword">if</span> p==r][<span class="number">0</span>]</span><br><span class="line">print(<span class="string">'precision: '</span>,precision_rt[index_cnt],<span class="string">', recall: '</span>,recall_rt[index_cnt])</span><br><span class="line"></span><br><span class="line"><span class="comment"># fixed Threshold</span></span><br><span class="line">threshold_fixed = threshold_rt[index_cnt]</span><br><span class="line">print(<span class="string">'threshold: '</span>,threshold_fixed)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">precision:  0.10752688172043011 , recall:  0.10752688172043011</span><br><span class="line">threshold:  0.40777142413843237</span><br></pre></td></tr></table></figure>
<h3 id="9-Predict-Test"><a href="#9-Predict-Test" class="headerlink" title="9. Predict Test"></a>9. Predict Test</h3><p>ì´ì œ í…ŒìŠ¤íŠ¸ ì…‹ì— ì ìš©í•´ë³¼ ì°¨ë¡€ì´ë‹¤. í•™ìŠµí•˜ì˜€ë˜ LSTM Autoencoder ëª¨ë¸ì„ í†µí•´ í…ŒìŠ¤íŠ¸ ì…‹ì„ ì˜ˆì¸¡ í›„ ì¬êµ¬ì„± ì†ì‹¤ì„ ê³„ì‚°í•œë‹¤. ê·¸ í›„ ìœ„ì—ì„œ ì°¾ì€ thresholdë¥¼ ì ìš©í•˜ì—¬ Normalê³¼ Breakë¥¼ êµ¬ë¶„í•œë‹¤.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">test_x_predictions = lstm_ae.predict(x_test_scaled)</span><br><span class="line">mse = np.mean(np.power(flatten(x_test_scaled) - flatten(test_x_predictions), <span class="number">2</span>), axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">error_df = pd.DataFrame(&#123;<span class="string">'Reconstruction_error'</span>: mse,</span><br><span class="line">                         <span class="string">'True_class'</span>: y_test.tolist()&#125;)</span><br><span class="line"></span><br><span class="line">groups = error_df.groupby(<span class="string">'True_class'</span>)</span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> name, group <span class="keyword">in</span> groups:</span><br><span class="line">    ax.plot(group.index, group.Reconstruction_error, marker=<span class="string">'o'</span>, ms=<span class="number">3.5</span>, linestyle=<span class="string">''</span>,</span><br><span class="line">            label= <span class="string">"Break"</span> <span class="keyword">if</span> name == <span class="number">1</span> <span class="keyword">else</span> <span class="string">"Normal"</span>)</span><br><span class="line">ax.hlines(threshold_fixed, ax.get_xlim()[<span class="number">0</span>], ax.get_xlim()[<span class="number">1</span>], colors=<span class="string">"r"</span>, zorder=<span class="number">100</span>, label=<span class="string">'Threshold'</span>)</span><br><span class="line">ax.legend()</span><br><span class="line">plt.title(<span class="string">"Reconstruction error for different classes"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"Reconstruction error"</span>)</span><br><span class="line">plt.xlabel(<span class="string">"Data point index"</span>)</span><br><span class="line">plt.show();</span><br></pre></td></tr></table></figure></p>
<p><img src="/image/lstm-autoencoder-code6.PNG"></p>
<h3 id="10-Evaluation"><a href="#10-Evaluation" class="headerlink" title="10. Evaluation"></a>10. Evaluation</h3><h4 id="confusion-matrix"><a href="#confusion-matrix" class="headerlink" title="confusion matrix"></a>confusion matrix</h4><p>í…ŒìŠ¤íŠ¸ ì…‹ì— ëŒ€í•œ ì¬êµ¬ì„± ì†ì‹¤ì„ thresholdë¥¼ ê¸°ì¤€ìœ¼ë¡œ 0/1ë¡œ ë‚˜ëˆ„ê³  ì´ë¥¼ confusion matrixë¡œ í‘œí˜„í•˜ì˜€ë‹¤.<br>Breakì— ëŒ€í•œ ì˜ˆì¸¡ ê²°ê³¼ê°€ ì‹¤ë§ìŠ¤ëŸ¬ìš¸ ìˆ˜ ìˆì§€ë§Œ ì´ë ‡ê²Œ Sheet Breakì˜ 10%ë§Œ ì¤„ì—¬ë„ ì—„ì²­ë‚œ ì†ì‹¤ì„ ì¤„ì¼ ìˆ˜ ìˆë‹¤ê³  í•œë‹¤.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># classification by threshold</span></span><br><span class="line">pred_y = [<span class="number">1</span> <span class="keyword">if</span> e &gt; threshold_fixed <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> e <span class="keyword">in</span> error_df[<span class="string">'Reconstruction_error'</span>].values]</span><br><span class="line"></span><br><span class="line">conf_matrix = metrics.confusion_matrix(error_df[<span class="string">'True_class'</span>], pred_y)</span><br><span class="line">plt.figure(figsize=(<span class="number">7</span>, <span class="number">7</span>))</span><br><span class="line">sns.heatmap(conf_matrix, xticklabels=LABELS, yticklabels=LABELS, annot=<span class="keyword">True</span>, fmt=<span class="string">'d'</span>)</span><br><span class="line">plt.title(<span class="string">'Confusion Matrix'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'Predicted Class'</span>); plt.ylabel(<span class="string">'True Class'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></p>
<p><img src="/image/lstm-autoencoder-code7.PNG"></p>
<h4 id="ROC-Curve-and-AUC"><a href="#ROC-Curve-and-AUC" class="headerlink" title="ROC Curve and AUC"></a>ROC Curve and AUC</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">false_pos_rate, true_pos_rate, thresholds = metrics.roc_curve(error_df[<span class="string">'True_class'</span>], error_df[<span class="string">'Reconstruction_error'</span>])</span><br><span class="line">roc_auc = metrics.auc(false_pos_rate, true_pos_rate,)</span><br><span class="line"></span><br><span class="line">plt.plot(false_pos_rate, true_pos_rate, linewidth=<span class="number">5</span>, label=<span class="string">'AUC = %0.3f'</span>% roc_auc)</span><br><span class="line">plt.plot([<span class="number">0</span>,<span class="number">1</span>],[<span class="number">0</span>,<span class="number">1</span>], linewidth=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">plt.xlim([<span class="number">-0.01</span>, <span class="number">1</span>])</span><br><span class="line">plt.ylim([<span class="number">0</span>, <span class="number">1.01</span>])</span><br><span class="line">plt.legend(loc=<span class="string">'lower right'</span>)</span><br><span class="line">plt.title(<span class="string">'Receiver operating characteristic curve (ROC)'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'True Positive Rate'</span>); plt.xlabel(<span class="string">'False Positive Rate'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/image/lstm-autoencoder-code8.PNG"></p>
<h3 id="11-Result"><a href="#11-Result" class="headerlink" title="11. Result"></a>11. Result</h3><p>ìµœì¢…ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ì…‹ì— ëŒ€í•œ ì¬êµ¬ì„± ì†ì‹¤ì„ thresholdë¥¼ í†µí•´ êµ¬ë¶„í•œ <code>pred_y</code>ì˜ ë§ˆì§€ë§‰ 5ë²ˆì§¸(timestepë§Œí¼)ì„ ì¶œë ¥í•˜ì—¬ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pred_y[<span class="number">-5</span>:]  <span class="comment"># [0, 0, 1, 0, 0]</span></span><br></pre></td></tr></table></figure></p>
<p>ìœ„ ê²°ê³¼ë¥¼ í•´ì„í•˜ê¸°ê°€ ì• ë§¤ëª¨í˜¸í•œ ë¶€ë¶„ì´ ìˆì§€ë§Œ, ëŒ€ëµ ë„“ê²Œ ì¡ì•˜ì„ ë•Œ ìµœì†Œ 10ë¶„ ì´ë‚´ì—ëŠ” Breakê°€ ë°œìƒí•  ê²ƒ ê°™ë‹¤ê³  í•´ì„í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</p>
<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a href="https://towardsdatascience.com/extreme-rare-event-classification-using-autoencoders-in-keras-a565b386f098" target="_blank" rel="noopener">Extreme Rare Event Classification using Autoencoders in Keras</a></li>
<li><a href="https://towardsdatascience.com/lstm-autoencoder-for-extreme-rare-event-classification-in-keras-ce209a224cfb" target="_blank" rel="noopener">LSTM Autoencoder for Extreme Rare Event Classification in Keras</a></li>
<li><a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/" target="_blank" rel="noopener">Understanding LSTM Networks</a></li>
<li><a href="https://m.blog.naver.com/PostView.nhn?blogId=chunjein&amp;logNo=221589624838&amp;proxyReferer=https%3A%2F%2Fwww.google.com%2F" target="_blank" rel="noopener">LSTM TimeDistributed layer</a></li>
<li><a href="https://stackoverflow.com/questions/51749404/how-to-connect-lstm-layers-in-keras-repeatvector-or-return-sequence-true" target="_blank" rel="noopener">How to connect LSTM layers in Keras, RepeatVector or return_sequence=True?</a></li>
</ul>

  <p><a class="classtest-link" href="/tags/autoencoder/">autoencoder</a>, <a class="classtest-link" href="/tags/deeplearning/">deeplearning</a>, <a class="classtest-link" href="/tags/lstm/">lstm</a>, <a class="classtest-link" href="/tags/lstmautoencoder/">lstmautoencoder</a>, <a class="classtest-link" href="/tags/machinelearning/">machinelearning</a>, <a class="classtest-link" href="/tags/prediction/">prediction</a>, <a class="classtest-link" href="/tags/shifting/">shifting</a>, <a class="classtest-link" href="/tags/windowing/">windowing</a> â€” Feb 29, 2020</p>
  
  <hr>
<section id="comments" class="mt-2 mb-3">

  <div id="disqus_thread">
    <a href="#" class="button button-primary" onclick="loadDisqus();return false;">View / Make Comments</a>
  </div>

  <script>
    var disqus_config = function() {
      this.page.url = 'https://jaehyeongan.github.io/2020/02/29/LSTM-Autoencoder-for-Anomaly-Detection/index.html';
      this.page.identifier = '2020/02/29/LSTM-Autoencoder-for-Anomaly-Detection/index.html';
      this.page.title = 'LSTM Autoencoder for Anomaly Detection';
    };

    var is_disqus_loaded = false;

    function loadDisqus() {
      if (!is_disqus_loaded) {
        is_disqus_loaded = true;

        var d = document,
          s = d.createElement('script');
        s.src = 'https://jaehyeongan.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      }
    }

  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>



          <div class="row mt-2">
  
    <div class="eight columns">
      <p id="madewith">Made with â¤ and
        <a class="footer-link icon" href="https://hexo.io" target="_blank" style="text-decoration: none;" rel="noreferrer" aria-label="Hexo.io">
        <svg class="hexo svg-hov" width="14" role="img" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><title>Hexo.js</title><path d="M12 .007L1.57 6.056V18.05L12 23.995l10.43-6.049V5.952L12 .007zm4.798 17.105l-.939.521-.939-.521V12.94H9.08v4.172l-.94.521-.938-.521V6.89l.939-.521.939.521v4.172h5.84V6.89l.94-.521.938.521v10.222z"/></svg>
        </a>
        
        at <a href="https://en.wikipedia.org/wiki/Earth" target="_blank" rel="noreferrer">Earth</a>.</p>
        
    </div>

    <!-- Sepcial thanks to https://simpleicons.org/ for the icons -->
    <div class="four columns mb-3 posisi">
      
      <a class="ml-0 footer-link icon" href="https://github.com/jaehyeongAN" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="GitHub">
        <svg class="github svg-hov" width="18" role="img" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
      </a>
      

      
      <a class="ml-0 footer-link icon" href="https://www.linkedin.com/in/jaehyeong-an-005603160/" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="LinkedIn">
        <svg class="linkedin svg-hov" width="18" role="img" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
      </a>
      

      

      
      <a class="ml-0 footer-link icon" href="https://www.instagram.com/an_jh.ds/" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="Instagram">
        <svg class="instagram svg-hov" width="18" role="img" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Instagram</title><path d="M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z"/></svg>
      </a>
      

    </div>
  
</div>

        </div>
      </div>

    </div>

  </div>
  <script src="/js/nanobar.min.js"></script>
  <script>
    var options = {
      classname: 'nanobar',
      id: 'myNanobar'
    };
    var nanobar = new Nanobar(options);
    nanobar.go(30);
    nanobar.go(76);
    nanobar.go(100);
  </script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>

</html>
